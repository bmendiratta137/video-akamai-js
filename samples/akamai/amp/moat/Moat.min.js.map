{"version":3,"sources":["../../../../src/Moat.js","../../../../src/MoatFlash.js","../../../../src/main.js"],"names":["config","this","Moat","__proto__","Object","getPrototypeOf","call","player","ads","onadbreakstart","bind","data","vo","akamai","Plugin","MoatFlash","xml","event","detail","metrics","vendor","createElement","appendChild","partnerCode","key","value","slicer1","slicer2","props","prop","forEach","amp","FlashPlugin","registerPlugin"],"mappings":"oHAEsBA,0BAAQC,MAAAC,EAAAC,WAAAC,OAAAC,eAAAH,IAAAI,KAAAL,KAAAM,EAAAP,qIAMtBQ,iBACF,aAAAP,KAAAQ,eAAAC,KAAAT,iJAQF,OAAMU,kBAAN,MAAAC,GAAA,MAAAD,yWAjB8BE,EAAWC,SAAAA,2ECE/BP,0BAAgBN,MAAAc,EAAAZ,WAAAC,OAAAC,eAAAU,IAAAT,KAAAL,KAAAM,EAAAP,uIAepBgB,EAAMC,EAAMC,qBAAlB,WAAA,EAEcF,OAAVG,mCAEAA,YAAiBA,kEAKfC,YAAaC,WAEXC,MAAYF,KAApBpB,OAAAW,KAAAY,YAAAC,IAAA,gBAAAC,MAAAxB,KAAAD,OAAAW,KAAAe,QAAAF,IAAA,YAAAC,MAAAxB,KAAAD,OAAAW,KAAAgB,QAAAH,IAAA,cAEMI,QACJ,SAAQC,uBAKJC,eAAQd,EAAUa,EAAML,IAAAK,EAAAJ,MAAAL,+EA7BvB,8DACD,OACC,4EAT4BP,IAAOkB,IAAIC,eAAAA,OAAAA,OAAAA,OAAAA,IAAAA,OAAAA,cAAAA,qFCIlDnB,EAAOkB,KAAQE","file":"akamai/amp/moat/Moat.min.js","sourcesContent":["export default class Moat extends akamai.amp.Plugin {\n\n  constructor(player, config) {\n    super(player, config)\n  }\n\n  onready(event) {\n    let ads = this.player.ads\n    if (ads == null)\n      return\n\n    ads.addEventListener(\"breakstart\", this.onadbreakstart.bind(this))\n    ads.addEventListener(\"managerloaded\", this.onadmanagerloaded.bind(this))\n  }\n\n  track() {\n    const vo = this.adsManagerVO\n    const data = this.data\n\n    if (initMoatTracking == null || vo == null || data == null) {\n      return\n    }\n\n    initMoatTracking(vo.adManager, {\"partnerCode\": data.partnerCode, \"viewMode\": vo.viewMode, \"slicer1\": data.slicer1, \"slicer2\": data.slicer2}, vo.adContainer)\n  }\n\n  onmediachange(event) {\n    this.adsManagerVO = null\n  }\n\n  onadbreakstart(event) {\n    this.track()\n  }\n\n  onadmanagerloaded(event) {\n    this.adsManagerVO = event.detail\n    this.track()\n  }\n}\n","export default class MoatFlash extends akamai.amp.FlashPlugin {\n\n  constructor(player, config) {\n    super(player, config)\n  }\n\n  get flashPlugins() {\n    return [{\n      id: \"MOATAnalyticsPlugin\",\n      src: \"#{paths.resources}plugins/MOATAnalyticsPlugin.swf\",\n      blocking: false,\n      host: \"akamai\",\n      main: \"MOATAnalyticsPlugin\"\n    }]\n  }\n\n  createXML(event) {\n    const xml = event.detail.xml\n    const application = xml.firstChild\n    let metrics = xml.getElementsByTagName(\"metrics\")[0]\n\n    if (metrics == null) {\n      metrics = xml.createElement(\"metrics\")\n      application.appendChild(metrics)\n    }\n\n    const vendor = xml.createElement(\"vendor\")\n    vendor.setAttribute(\"id\", \"moat\")\n    metrics.appendChild(vendor)\n\n    const props = [\n      {value: this.config.data.partnerCode, key: \"partnerCode\"},\n      {value: this.config.data.slicer1, key: \"slicer1\"},\n      {value: this.config.data.slicer2, key: \"slicer2\"}\n    ]\n\n    props.forEach(function (prop) {\n      if (prop.value == null)\n        return\n      this.createProperty(xml, prop.key, prop.value, vendor)\n    })\n  }\n}\n","import Moat from \"./Moat.js\"\nimport MoatFlash from \"./MoatFlash.js\"\n\nakamai.amp.AMP.registerPlugin(\"moat\", \"html\", akamai.amp.Plugin.createFactory(Moat))\nakamai.amp.AMP.registerPlugin(\"moat\", \"flash\", akamai.amp.Plugin.createFactory(MoatFlash))\n\nexport {Moat}\nexport {MoatFlash}\n"]}