{"version":3,"file":"Mrss.js","sources":["../../../../src/MRSSEvents.js","../../../../src/MRSS.js","../../../../src/main.js"],"sourcesContent":["export default {\n  CHANGED: \"changed\",\n  ERROR: \"error\",\n  REQUEST: \"request\",\n  LOADED: \"laoded\"\n}\n","import MRSSEvents from \"./MRSSEvents\"\n\nexport default class MRSS extends akamai.amp.Plugin {\n  constructor(player, config) {\n    super(player, config)\n\n    this.feature = \"feed\"\n    this.helper = new akamai.amp.utils.MRSSHelper()\n  }\n\n  get data() {\n    return this._data\n  }\n\n  set data(value) {\n    this._data = value\n    this.feed = this.helper.createFeed(value)\n    this.player.media = this.feed.item[0]\n    this.dispatch(MRSSEvents.CHANGED, this.feed)\n  }\n\n  get url() {\n    return this._url\n  }\n\n  set url(value) {\n    this._url = this.player.evaluatePaths(value)\n\n    this.dispatch(MRSSEvents.REQUEST, this._url)\n    this.helper.getFeed(this._url)\n      .then((feed) => {\n        this.dispatch(MRSSEvents.LOADED, feed)\n        this.data = feed\n      })\n      .catch((error) => {\n        this.dispatch(MRSSEvents.ERROR, {error: error, url: value})\n        this.logger.error(\"[AMP Feed Load Error]\", this._url, error)\n      })\n  }\n\n  mediaTransform(feed) {\n    let promise = Promise.resolve(feed)\n    const helper = new akamai.amp.utils.MRSSHelper()\n\n    if (typeof feed == \"string\") {\n      promise = helper.getFeed(feed)\n    }\n\n    promise = promise.then((feed) => {\n      return helper.createFeed(feed).item[0]\n    })\n\n    return promise\n  }\n\n  onready() {\n    const url = this.config.url\n    const data = this.config.data\n    let func = null\n\n    if (url != null && url != \"\")\n      func = () => this.url = url\n    else if (data != null)\n      func = () => this.data = data\n\n    if (typeof func == \"function\")\n      setTimeout(func, 1)\n  }\n}\n","import MRSS from \"./MRSS\"\n\nakamai.amp.AMP.registerPlugin(\"mrss\", akamai.amp.Plugin.createFactory(MRSS))\n\nexport {default as MRSSEvents} from \"./MRSSEvents\"\nexport {MRSS}\n"],"names":["MRSS","player","config","feature","helper","akamai","amp","utils","MRSSHelper","feed","promise","Promise","resolve","getFeed","then","createFeed","item","url","data","func","setTimeout","_data","value","media","dispatch","MRSSEvents","CHANGED","_url","evaluatePaths","REQUEST","LOADED","catch","error","ERROR","logger","Plugin","AMP","registerPlugin","createFactory"],"mappings":";;;;;AAAA,iBAAe;WACJ,SADI;SAEN,OAFM;WAGJ,SAHI;UAIL;CAJV;;ICEqBA;;;gBACPC,MAAZ,EAAoBC,MAApB,EAA4B;;;wHACpBD,MADoB,EACZC,MADY;;UAGrBC,OAAL,GAAe,MAAf;UACKC,MAAL,GAAc,IAAIC,OAAOC,GAAP,CAAWC,KAAX,CAAiBC,UAArB,EAAd;;;;;;mCAiCaC,MAAM;UACfC,UAAUC,QAAQC,OAAR,CAAgBH,IAAhB,CAAd;UACML,SAAS,IAAIC,OAAOC,GAAP,CAAWC,KAAX,CAAiBC,UAArB,EAAf;;UAEI,OAAOC,IAAP,IAAe,QAAnB,EAA6B;kBACjBL,OAAOS,OAAP,CAAeJ,IAAf,CAAV;;;gBAGQC,QAAQI,IAAR,CAAa,UAACL,IAAD,EAAU;eACxBL,OAAOW,UAAP,CAAkBN,IAAlB,EAAwBO,IAAxB,CAA6B,CAA7B,CAAP;OADQ,CAAV;;aAION,OAAP;;;;8BAGQ;;;UACFO,MAAM,KAAKf,MAAL,CAAYe,GAAxB;UACMC,OAAO,KAAKhB,MAAL,CAAYgB,IAAzB;UACIC,OAAO,IAAX;;UAEIF,OAAO,IAAP,IAAeA,OAAO,EAA1B,EACEE,OAAO;eAAM,OAAKF,GAAL,GAAWA,GAAjB;OAAP,CADF,KAEK,IAAIC,QAAQ,IAAZ,EACHC,OAAO;eAAM,OAAKD,IAAL,GAAYA,IAAlB;OAAP;;UAEE,OAAOC,IAAP,IAAe,UAAnB,EACEC,WAAWD,IAAX,EAAiB,CAAjB;;;;wBAxDO;aACF,KAAKE,KAAZ;;sBAGOC,OAAO;WACTD,KAAL,GAAaC,KAAb;WACKb,IAAL,GAAY,KAAKL,MAAL,CAAYW,UAAZ,CAAuBO,KAAvB,CAAZ;WACKrB,MAAL,CAAYsB,KAAZ,GAAoB,KAAKd,IAAL,CAAUO,IAAV,CAAe,CAAf,CAApB;WACKQ,QAAL,CAAcC,WAAWC,OAAzB,EAAkC,KAAKjB,IAAvC;;;;wBAGQ;aACD,KAAKkB,IAAZ;;sBAGML,OAAO;;;WACRK,IAAL,GAAY,KAAK1B,MAAL,CAAY2B,aAAZ,CAA0BN,KAA1B,CAAZ;;WAEKE,QAAL,CAAcC,WAAWI,OAAzB,EAAkC,KAAKF,IAAvC;WACKvB,MAAL,CAAYS,OAAZ,CAAoB,KAAKc,IAAzB,EACGb,IADH,CACQ,UAACL,IAAD,EAAU;eACTe,QAAL,CAAcC,WAAWK,MAAzB,EAAiCrB,IAAjC;eACKS,IAAL,GAAYT,IAAZ;OAHJ,EAKGsB,KALH,CAKS,UAACC,KAAD,EAAW;eACXR,QAAL,CAAcC,WAAWQ,KAAzB,EAAgC,EAACD,OAAOA,KAAR,EAAef,KAAKK,KAApB,EAAhC;eACKY,MAAL,CAAYF,KAAZ,CAAkB,uBAAlB,EAA2C,OAAKL,IAAhD,EAAsDK,KAAtD;OAPJ;;;;EA3B8B3B,OAAOC,GAAP,CAAW6B;;ACA7C9B,OAAOC,GAAP,CAAW8B,GAAX,CAAeC,cAAf,CAA8B,MAA9B,EAAsChC,OAAOC,GAAP,CAAW6B,MAAX,CAAkBG,aAAlB,CAAgCtC,IAAhC,CAAtC,EAEA,AACA;;;;;"}